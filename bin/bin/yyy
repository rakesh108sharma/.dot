#!/bin/bash
#

function error
{
    herber "ERROR"
    exit 1 
}

# menu 
action=$(echo "\
add
delete
" | dmenu -i -p "action?")
[ -z "$action" ] && exit 2  


case "$action" in
    "add") 
        packages=$(xbps-query -Rs '' | cut -d' ' -f2-)
        package=$(echo "$packages" | dmenu -i | cut -d' ' -f1)
        [ -z "$package" ] && exit 1
        sudo xbps-install -y "$package" || error
        herbe "$package"  " "  "   INSTALLED"
        ;;
    "delete")
        packages=$(xbps-query -s '' | cut -d' ' -f2-)
        package=$(echo "$packages" | dmenu -i)
        [ -z "$package" ] && exit 1
        package=${package%% *}
        sudo xbps-remove -y "$package"  ||  error 
        herbe "$package"  " "  "   DELETED"
        ;; 
    *)
        error
        ;;
esac
    

exit 0
